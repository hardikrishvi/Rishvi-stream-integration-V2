using AutoMapper;
using LinnworksMacroHelpers;
using Microsoft.EntityFrameworkCore;
using Microsoft.Extensions.Configuration;
using Microsoft.Extensions.Options;
using Newtonsoft.Json;
using RestSharp;
using Rishvi.Modules.Core;
using Rishvi.Modules.Core.Authorization;
using Rishvi.Modules.Core.Content;
using Rishvi.Modules.Core.Data;
using Rishvi.Modules.Core.DTOs;
using Rishvi.Modules.Core.Helpers;
using Rishvi.Modules.Core.Validators;
using Rishvi.Modules.Users.Models;
using Rishvi.Modules.Users.Models.DTOs;
using Rishvi.Modules.Users.Validators;
using System;
using System.Linq;
using System.Threading.Tasks;

namespace Rishvi.Modules.Users.Services
{
    public interface IUserService
    {
        InstallResponse InstallAppUser(string token);
        Task<Result> AuthorizedByApplicationToken(Guid token);
        User GetUserByLinnworksToken(Guid token);
        Task<Result> GetUserWiseFtpAsync(Guid token);
        Task<Result> UpdateUserFTPAsync(Guid token, UserWiseFtpUpdateDto dto);
    }

    public class UserService : IUserService
    {
        private readonly IUnitOfWork _unitOfWork;
        private readonly IConfiguration _config;
        private readonly IRepository<User> _userRepository;
        private readonly IRepository<UserWiseFtp> _userWiseFtpRepository;
        private readonly LinnworkAppCredential _linnworkAppCredential;
        private readonly IMapper _mapper;
        private readonly UserWiseFtpUpdateValidator _userWiseFtpUpdateValidator;
        public UserService(IRepository<User> userRepository,
            IRepository<UserWiseFtp> userWiseFtpRepository,
            IUnitOfWork unitOfWork,
            IConfiguration config,
            IMapper mapper,
            IOptions<LinnworkAppCredential> linnworkAppCredential,
            UserWiseFtpUpdateValidator userWiseFtpUpdateValidator)
        {
            _userRepository = userRepository;
            _userWiseFtpRepository = userWiseFtpRepository;
            _unitOfWork = unitOfWork;
            _config = config;
            _mapper = mapper;
            _linnworkAppCredential = linnworkAppCredential.Value;
            _userWiseFtpUpdateValidator = userWiseFtpUpdateValidator;
        }

        public InstallResponse InstallAppUser(string token)
        {
            var result = new Result();
            try
            {
                var client = new RestClient("https://api.linnworks.net/api/Auth/AuthorizeByApplication");
                LinnworkAuthFilterDto filter = new LinnworkAuthFilterDto()
                {
                    ApplicationId = _config.GetSection("LinnworkAppCredential").GetSection("ApplicationId").Value,
                    ApplicationSecret = _config.GetSection("LinnworkAppCredential").GetSection("ApplicationSecret").Value,
                    Token = token
                };
                RestRequest request = new RestRequest();
                request.Method = Method.Post;

                var filterJson = JsonConvert.SerializeObject(filter);
                request.AddParameter("application/json", filterJson, ParameterType.RequestBody);

                RestResponse response = client.Execute(request);
                if (response.StatusCode == System.Net.HttpStatusCode.OK)
                {
                    var linnworkAuthDto = JsonConvert.DeserializeObject<LinnworkAuthDto>(response.Content);

                    var user = _userRepository.Get().FirstOrDefault(f => f.LinnworksId == linnworkAuthDto.Id);
                    if (user != null)
                    {
                        //Update code
                        user.LinnworksApplicationToken = Guid.Parse(token);
                        user.LinnworksUserToken = linnworkAuthDto.Token;
                        user.LinnworksServerUrl = linnworkAuthDto.Server;
                        user.UpdatedAt = DateTime.UtcNow;

                        _userRepository.Update(user);
                        _unitOfWork.Commit();

                        result.SetSuccess("Result found successfully.");
                        result.Data = user;

                        LinnworksMacroBaseStatic.AuthorizeByApplication(Guid.Parse(string.IsNullOrEmpty(token) ? _linnworkAppCredential.Token : token), Guid.Parse(_linnworkAppCredential.ApplicationId), Guid.Parse(_linnworkAppCredential.ApplicationSecret));

                        var responseOrderViewList = LinnworksMacroBaseStatic.Api.Orders.GetOrderViews();

                        if (responseOrderViewList == null || !responseOrderViewList.Any(a => a.ViewName == "Ready to Print"))
                            ReadyToPrintView(user.LinnworksUserToken.ToString(), user.LinnworksServerUrl);

                        if (responseOrderViewList == null || !responseOrderViewList.Any(a => a.ViewName == "Label Printed"))
                            LabelPrintedView(user.LinnworksUserToken.ToString(), user.LinnworksServerUrl);

                        if (responseOrderViewList == null || !responseOrderViewList.Any(a => a.ViewName == "Label Error"))
                            LabelErrorView(user.LinnworksUserToken.ToString(), user.LinnworksServerUrl);
                    }
                    else
                    {
                        //Insert Code
                        User userEntity = new User();
                        try
                        {
                            var splitFullName = linnworkAuthDto.FullName.Split(" ");
                            if (splitFullName.Length >= 1)
                            {
                                userEntity.Firstname = splitFullName[0];
                                if (splitFullName.Length >= 2)
                                {
                                    userEntity.Lastname = splitFullName[1];
                                }
                            }
                        }
                        catch (Exception)
                        {
                        }

                        userEntity.EmailAddress = linnworkAuthDto.Email;
                        userEntity.Username = linnworkAuthDto.UserName;
                        userEntity.Company = linnworkAuthDto.Company;
                        userEntity.IsDeleted = false;
                        userEntity.IsActive = true;
                        userEntity.LinnworksId = linnworkAuthDto.Id;
                        userEntity.LinnworksApplicationToken = Guid.Parse(token);
                        userEntity.LinnworksUserToken = linnworkAuthDto.Token;
                        userEntity.LinnworksServerUrl = linnworkAuthDto.Server;
                        userEntity.CreatedAt = DateTime.UtcNow;

                        _userRepository.Add(userEntity);
                        _unitOfWork.Commit();

                        LinnworksMacroBaseStatic.AuthorizeByApplication(Guid.Parse(string.IsNullOrEmpty(token) ? _linnworkAppCredential.Token : token), Guid.Parse(_linnworkAppCredential.ApplicationId), Guid.Parse(_linnworkAppCredential.ApplicationSecret));

                        var responseOrderViewList = LinnworksMacroBaseStatic.Api.Orders.GetOrderViews();

                        if (responseOrderViewList == null || !responseOrderViewList.Any(a => a.ViewName == "Ready to Print"))
                            ReadyToPrintView(userEntity.LinnworksUserToken.ToString(), userEntity.LinnworksServerUrl);

                        if (responseOrderViewList == null || !responseOrderViewList.Any(a => a.ViewName == "Label Printed"))
                            LabelPrintedView(userEntity.LinnworksUserToken.ToString(), userEntity.LinnworksServerUrl);

                        if (responseOrderViewList == null || !responseOrderViewList.Any(a => a.ViewName == "Label Error"))
                            LabelErrorView(userEntity.LinnworksUserToken.ToString(), userEntity.LinnworksServerUrl);

                        result.SetSuccess("Result found successfully.");
                        result.Data = userEntity;
                    }


                }
                else
                {
                    if (!string.IsNullOrEmpty(response.Content))
                        result.SetError(JsonConvert.DeserializeObject<RestResponseContent>(response.Content).Message);
                    else
                        result.SetError("Internal server error!");
                    return new InstallResponse()
                    {
                        success = false
                    };
                }

                return new InstallResponse()
                {
                    success = true
                };
            }
            catch (Exception ex)
            {
                return new InstallResponse()
                {
                    success = false
                };
            }
        }

        public async Task<Result> AuthorizedByApplicationToken(Guid token)
        {
            try
            {
                LinnworksMacroBaseStatic.AuthorizeByApplication(token, Guid.Parse(_linnworkAppCredential.ApplicationId), Guid.Parse(_linnworkAppCredential.ApplicationSecret));

                var authorized = LinnworksMacroBaseStatic.authorized;

                var query = _userRepository.AsNoTracking()
                    .Where(w => w.LinnworksId == authorized.Id)
                    .Select(s => new UserLinnworksDto()
                    {
                        LinnworksId = s.LinnworksId,
                        LinnworksApplicationToken = s.LinnworksApplicationToken,
                        LinnworksUserToken = s.LinnworksUserToken,
                        LinnworksServerUrl = s.LinnworksServerUrl
                    }).FirstOrDefault();
                if (query == null)
                    return await Task.FromResult(new Result().SetError("Invalid Token"));
                else
                {
                    return await Task.FromResult(new Result().SetData(query));
                }
                //}
                //else
                //    return await Task.FromResult(new Result().SetError(JsonConvert.DeserializeObject<RestResponseContent>(restResult.Content).Message));

            }
            catch (Exception ex)
            {
                return await Task.FromResult(new Result().SetError(ex.Message));
            }
        }

        public User GetUserByLinnworksToken(Guid token)
        {
            var entity = _userRepository.AsNoTracking().Where(w => w.LinnworksApplicationToken == token).FirstOrDefault();
            return entity;
        }
        public async Task<Result> GetUserWiseFtpAsync(Guid token)
        {
            try
            {
                //LinnworksMacroBaseStatic.AuthorizeByApplication(token, Guid.Parse(_linnworkAppCredential.ApplicationId), Guid.Parse(_linnworkAppCredential.ApplicationSecret));
                var userProfileDto = new UserWiseFtpUpdateDto();
                var query = _userRepository.AsNoTracking()
                    .Include(i => i.UserWiseFtp)
                    .Where(w => !w.IsDeleted && w.IsActive && w.LinnworksApplicationToken == token)
                    .FirstOrDefault();

                if (query == null)
                    userProfileDto.UserId = query.UserId;
                else
                {
                    if (query.UserWiseFtp.Count > 0)
                    {
                        userProfileDto = _mapper.Map<UserWiseFtpUpdateDto>(query.UserWiseFtp[0]);
                    }
                    userProfileDto.UserId = query.UserId;
                }
                return await Task.FromResult(new Result().SetSuccess().SetData(userProfileDto));
            }
            catch (Exception ex)
            {
                return await Task.FromResult(new Result().SetError(ex.Message));
            }
        }
        public async Task<Result> UpdateUserFTPAsync(Guid token, UserWiseFtpUpdateDto dto)
        {
            try
            {
                LinnworksMacroBaseStatic.AuthorizeByApplication(token, Guid.Parse(_linnworkAppCredential.ApplicationId), Guid.Parse(_linnworkAppCredential.ApplicationSecret));

                dto ??= new UserWiseFtpUpdateDto();

                var result = await _userWiseFtpUpdateValidator.ValidateResultAsync(dto);
                if (!result.Success)
                    return result;
                var entity = await _userWiseFtpRepository.AsNoTracking()
                    .Include(i => i.User)
                    .Where(w => w.UserId == dto.UserId)
                    .FirstOrDefaultAsync();



                if (entity == null)
                {
                    //var newEntity = new UserWiseFtp()
                    //{
                    //    UserId = dto.UserId,
                    //    UserName = dto.UserName,
                    //    Password = dto.Password,
                    //    Host = dto.Host,
                    //    Port = dto.Port,
                    //    //IsSSL = dto.IsSSL
                    //};
                    var testEntity = new UserWiseFtp();
                    _mapper.Map(dto, testEntity);
                    await _userWiseFtpRepository.AddAsync(testEntity);
                }
                else
                {
                    _mapper.Map(dto, entity);
                    await _userWiseFtpRepository.UpdateAsync(entity);
                }


                await _unitOfWork.CommitAsync();

                return await result.SetSuccessAsync(Messages.RecordSaved);
            }
            catch (Exception ex)
            {
                return await new Result().SetErrorAsync(ex.Message);
            }
        }

        public void ReadyToPrintView(string token, string serverUrl = "https://eu-ext.linnworks.net")
        {
            try
            {
                var client = new RestClient(serverUrl + "/api/Orders/CreateOrderView");

                CreateOrderViewRequestDto filter = new CreateOrderViewRequestDto()
                {
                    viewName = "Ready to Print",
                    OrderViewDetailJSON = @"{""FieldsVisibility"":[{""Name"":""General"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""GENERAL_INFO"",""SubFields"":[{""Name"":""Order Id"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_ORDER_ID"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6622""},{""Name"":""Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6623""},{""Name"":""Channel Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_CHANNEL_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6624""},{""Name"":""External Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_EXTERNAL_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6625""},{""Name"":""Date"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Date"",""Code"":""GENERAL_INFO_DATE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6626""},{""Name"":""Source"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_SOURCE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6627""},{""Name"":""Sub Source"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_SUBSOURCE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6628""},{""Name"":""Label printed"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_LABEL_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6629""},{""Name"":""Invoice printed"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_INVOICE_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6630""},{""Name"":""Pick list printed"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PICK_LIST_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6631""},{""Name"":""Rules engine run"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_IS_RULE_RUN"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6632""},{""Name"":""Part shipped"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PART_SHIPPED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6633""},{""Name"":""Locked"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_LOCKED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6634""},{""Name"":""Parked"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PARKED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6635""},{""Name"":""Number of notes"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""GENERAL_INFO_NOTE_COUNT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6636""},{""Name"":""Tag"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""HtmlList"",""Code"":""GENERAL_INFO_TAG"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6637""},{""Name"":""Identifiers"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""List"",""Code"":""GENERAL_INFO_IDENTIFIER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6638""},{""Name"":""Status"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_STATUS"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6639""},{""Name"":""Delivery Dates"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Date"",""Code"":""GENERAL_INFO_DESPATCHBYDATE"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6640""},{""Name"":""Number of Items"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""GENERAL_INFO_ITEMS_COUNT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6641""},{""Name"":""Shipping Label Error"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""Text"",""Code"":""GENERAL_INFO_SHIPPING_LABEL_ERROR"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":true,""$$hashKey"":""object:6642""},{""Name"":""Has Shipping Label Error"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_HAS_SHIPPING_LABEL_ERROR"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":true,""$$hashKey"":""object:6643""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6596""},{""Name"":""Shipping"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""SHIPPING_INFORMATION"",""SubFields"":[{""Name"":""Service Id"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_SERVICE_ID"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6666""},{""Name"":""Vendor"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_VENDOR"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6667""},{""Name"":""Service"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_SERVICE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6668""},{""Name"":""Weight"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""SHIPPING_INFORMATION_WEIGHT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6669""},{""Name"":""Packaging Group"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_PACKAGING_GROUP"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6670""},{""Name"":""Packaging Type"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_PACKAGING_TYPE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6671""},{""Name"":""Shipping Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""SHIPPING_INFORMATION_COST"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6672""},{""Name"":""Tracking Number"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""SHIPPING_INFORMATION_TRACKING_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6673""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6597""},{""Name"":""Customer"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""CUSTOMER"",""SubFields"":[{""Name"":""Address 1"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS1"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6682""},{""Name"":""Address 2"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS2"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6683""},{""Name"":""Address 3"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS3"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6684""},{""Name"":""Company"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_COMPANY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6685""},{""Name"":""Customer Name"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_FULL_NAME"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6686""},{""Name"":""Post code"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_POSTCODE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6687""},{""Name"":""Town"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_TOWN"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6688""},{""Name"":""Billing Address"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""None"",""Code"":""CUSTOMER_BILLING_ADDRESS"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6689""},{""Name"":""Region"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_COUNTY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6690""},{""Name"":""Country"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""CUSTOMER_ADDRESS_COUNTRY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6691""},{""Name"":""Country Zone"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""CUSTOMER_ADDRESS_COUNTRY_ZONE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6692""},{""Name"":""Email"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_EMAIL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6693""},{""Name"":""Channel buyer name"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_CHANNEL_BUYER_NAME"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6694""},{""Name"":""Phone"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_PHONE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6695""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6598""},{""Name"":""Totals"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""TOTALS"",""SubFields"":[{""Name"":""Subtotal"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_SUBTOTAL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6710""},{""Name"":""Shipping"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_SHIPPING"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6711""},{""Name"":""Tax"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_TAX"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6712""},{""Name"":""Total"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_TOTAL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6713""},{""Name"":""Currency"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_CURRENCY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6714""},{""Name"":""Payment method"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_PAYMENT_METHOD"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6715""},{""Name"":""Country tax rate"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_COUNTRY_TAX_RATE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6716""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6599""},{""Name"":""Folder"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""FOLDER"",""SubFields"":[{""Name"":""Folder"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""FOLDER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6724""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6600""},{""Name"":""Items"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS"",""SubFields"":[{""Name"":""Image"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""ITEMS_IMAGE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6726""},{""Name"":""SKU"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_SKU"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6727""},{""Name"":""Original SKU"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_ORIGINAL_SKU"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6728""},{""Name"":""Title"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_TITLE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6729""},{""Name"":""Original Title"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Text"",""Code"":""ITEMS_ORIGINAL_TITLE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6730""},{""Name"":""Quantity"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""ITEMS_QUANTITY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6731""},{""Name"":""Line Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""ITEMS_LINE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6732""},{""Name"":""Currency"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_CURRENCY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6733""},{""Name"":""Product Category"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""ITEMS_CATEGORY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6734""},{""Name"":""Stock Level"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""List"",""Code"":""STOCK_LEVEL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6735""},{""Name"":""Bin Rack"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_BINRACK"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6736""},{""Name"":""Batched"",""Visible"":false,""CanFilter"":true,""CanSort"":false,""FieldType"":""Boolean"",""Code"":""ITEMS_BATCHED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6737""},{""Name"":""Weight"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_WEIGHT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6738""},{""Name"":""Unit Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_UNIT_COST"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6739""},{""Name"":""Price per unit"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_PRICE_PER_UNIT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6740""},{""Name"":""Barcode Number"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_BARCODE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6741""},{""Name"":""Tax Cost Inclusive"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""ITEMS_TAX_COST_INCLUSIVE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:6742""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6601""},{""Name"":""Hot buttons"",""Visible"":true,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTONS"",""SubFields"":[{""Name"":""Pick List (Shift + K)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-hand-o-up"",""HotButtonKey"":""TemplateDefined,Pick List"",""$$hashKey"":""object:6760""},{""Name"":""Shipping Labels (Shift + S)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-ticket"",""HotButtonKey"":""TemplateDefined,Shipping Labels"",""$$hashKey"":""object:6761""},{""Name"":""Print Invoices (Shift + I)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-file-text-o"",""HotButtonKey"":""TemplateDefined,Invoice Template"",""$$hashKey"":""object:6762""},{""Name"":""Process Orders (Shift + P)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-gavel"",""HotButtonKey"":""ProcessOrders"",""$$hashKey"":""object:6763""},{""Name"":""Shipping Label - Template"",""Code"":""HOT_BUTTON"",""HotButtonKey"":""PrintSpecificInvoice_52"",""Visible"":true,""$$hashKey"":""object:6764""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:6602""}],""Filters"":{""GENERAL_INFO"":[{""FieldCode"":""GENERAL_INFO_LABEL_PRINTED"",""Name"":""Label printed"",""FieldType"":""Boolean"",""Value"":""false""},{""FieldCode"":""GENERAL_INFO_HAS_SHIPPING_LABEL_ERROR"",""Name"":""Has Shipping Label Error"",""FieldType"":""Boolean"",""Value"":""false""},{""FieldCode"":""GENERAL_INFO_STATUS"",""Name"":""Status"",""FieldType"":""List"",""ListValues"":[""Paid"",""Unpaid"",""Return"",""Resend"",""Payment pending"",""Locked"",""Parked""],""Type"":0,""Value"":1}],""SHIPPING_INFORMATION"":[],""CUSTOMER"":[],""TOTALS"":[],""FOLDER"":[],""ITEMS"":[]},""Sorting"":{""GENERAL_INFO"":[{""Name"":""Order Id"",""FieldCode"":""GENERAL_INFO_ORDER_ID"",""Direction"":0,""Order"":1}],""SHIPPING_INFORMATION"":[],""CUSTOMER"":[],""TOTALS"":[],""FOLDER"":[],""ITEMS"":[]},""ColumnsConfig"":[{""Code"":""GENERAL_INFO"",""Column"":""generalInfoColumn"",""Width"":""15%""},{""Code"":""SHIPPING_INFORMATION"",""Column"":""shippingInfoColumn"",""Width"":""15%""},{""Code"":""CUSTOMER"",""Column"":""customerInfoColumn"",""Width"":""15%""},{""Code"":""TOTALS"",""Column"":""totalsInfoColumn"",""Width"":""15%""},{""Code"":""FOLDER"",""Column"":""folderInfoColumn"",""Width"":""20%""},{""Code"":""ITEMS"",""Column"":""itemsInfoColumn"",""Width"":""20%""}]}"
                };

                RestRequest request = new RestRequest();
                request.Method = Method.Post;

                request.AddHeader("Authorization", token);
                request.AddHeader("Content-Type", "application/json");

                var filterJson = JsonConvert.SerializeObject(filter);
                request.AddParameter("application/json", filterJson, ParameterType.RequestBody);

                RestResponse response = client.Execute(request);
            }
            catch (Exception ex)
            {

            }
        }

        public void LabelPrintedView(string token, string serverUrl = "https://eu-ext.linnworks.net")
        {
            try
            {
                var client = new RestClient(serverUrl + "/api/Orders/CreateOrderView");

                CreateOrderViewRequestDto filter = new CreateOrderViewRequestDto()
                {
                    viewName = "Label Printed",
                    OrderViewDetailJSON = @"{""FieldsVisibility"":[{""Name"":""General"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""GENERAL_INFO"",""SubFields"":[{""Name"":""Order Id"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_ORDER_ID"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26247""},{""Name"":""Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26248""},{""Name"":""Channel Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_CHANNEL_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26249""},{""Name"":""External Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_EXTERNAL_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26250""},{""Name"":""Date"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Date"",""Code"":""GENERAL_INFO_DATE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26251""},{""Name"":""Source"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_SOURCE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26252""},{""Name"":""Sub Source"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_SUBSOURCE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26253""},{""Name"":""Label printed"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_LABEL_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26254""},{""Name"":""Invoice printed"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_INVOICE_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26255""},{""Name"":""Pick list printed"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PICK_LIST_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26256""},{""Name"":""Rules engine run"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_IS_RULE_RUN"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26257""},{""Name"":""Part shipped"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PART_SHIPPED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26258""},{""Name"":""Locked"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_LOCKED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26259""},{""Name"":""Parked"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PARKED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26260""},{""Name"":""Number of notes"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""GENERAL_INFO_NOTE_COUNT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26261""},{""Name"":""Tag"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""HtmlList"",""Code"":""GENERAL_INFO_TAG"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26262""},{""Name"":""Identifiers"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""List"",""Code"":""GENERAL_INFO_IDENTIFIER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26263""},{""Name"":""Status"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_STATUS"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26264""},{""Name"":""Delivery Dates"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Date"",""Code"":""GENERAL_INFO_DESPATCHBYDATE"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26265""},{""Name"":""Number of Items"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""GENERAL_INFO_ITEMS_COUNT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26266""},{""Name"":""Shipping Label Error"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""Text"",""Code"":""GENERAL_INFO_SHIPPING_LABEL_ERROR"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":true,""$$hashKey"":""object:26267""},{""Name"":""Has Shipping Label Error"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_HAS_SHIPPING_LABEL_ERROR"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":true,""$$hashKey"":""object:26268""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26225""},{""Name"":""Shipping"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""SHIPPING_INFORMATION"",""SubFields"":[{""Name"":""Service Id"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_SERVICE_ID"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26291""},{""Name"":""Vendor"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_VENDOR"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26292""},{""Name"":""Service"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_SERVICE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26293""},{""Name"":""Weight"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""SHIPPING_INFORMATION_WEIGHT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26294""},{""Name"":""Packaging Group"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_PACKAGING_GROUP"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26295""},{""Name"":""Packaging Type"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_PACKAGING_TYPE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26296""},{""Name"":""Shipping Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""SHIPPING_INFORMATION_COST"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26297""},{""Name"":""Tracking Number"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""SHIPPING_INFORMATION_TRACKING_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26298""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26226""},{""Name"":""Customer"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""CUSTOMER"",""SubFields"":[{""Name"":""Address 1"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS1"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26307""},{""Name"":""Address 2"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS2"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26308""},{""Name"":""Address 3"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS3"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26309""},{""Name"":""Company"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_COMPANY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26310""},{""Name"":""Customer Name"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_FULL_NAME"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26311""},{""Name"":""Post code"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_POSTCODE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26312""},{""Name"":""Town"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_TOWN"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26313""},{""Name"":""Billing Address"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""None"",""Code"":""CUSTOMER_BILLING_ADDRESS"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26314""},{""Name"":""Region"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_COUNTY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26315""},{""Name"":""Country"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""CUSTOMER_ADDRESS_COUNTRY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26316""},{""Name"":""Country Zone"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""CUSTOMER_ADDRESS_COUNTRY_ZONE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26317""},{""Name"":""Email"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_EMAIL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26318""},{""Name"":""Channel buyer name"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_CHANNEL_BUYER_NAME"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26319""},{""Name"":""Phone"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_PHONE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26320""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26227""},{""Name"":""Totals"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""TOTALS"",""SubFields"":[{""Name"":""Subtotal"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_SUBTOTAL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26335""},{""Name"":""Shipping"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_SHIPPING"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26336""},{""Name"":""Tax"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_TAX"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26337""},{""Name"":""Total"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_TOTAL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26338""},{""Name"":""Currency"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_CURRENCY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26339""},{""Name"":""Payment method"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_PAYMENT_METHOD"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26340""},{""Name"":""Country tax rate"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_COUNTRY_TAX_RATE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26341""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26228""},{""Name"":""Folder"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""FOLDER"",""SubFields"":[{""Name"":""Folder"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""FOLDER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26349""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26229""},{""Name"":""Items"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS"",""SubFields"":[{""Name"":""Image"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""ITEMS_IMAGE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26351""},{""Name"":""SKU"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_SKU"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26352""},{""Name"":""Original SKU"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_ORIGINAL_SKU"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26353""},{""Name"":""Title"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_TITLE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26354""},{""Name"":""Original Title"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Text"",""Code"":""ITEMS_ORIGINAL_TITLE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26355""},{""Name"":""Quantity"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""ITEMS_QUANTITY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26356""},{""Name"":""Line Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""ITEMS_LINE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26357""},{""Name"":""Currency"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_CURRENCY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26358""},{""Name"":""Product Category"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""ITEMS_CATEGORY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26359""},{""Name"":""Stock Level"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""List"",""Code"":""STOCK_LEVEL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26360""},{""Name"":""Bin Rack"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_BINRACK"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26361""},{""Name"":""Batched"",""Visible"":false,""CanFilter"":true,""CanSort"":false,""FieldType"":""Boolean"",""Code"":""ITEMS_BATCHED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26362""},{""Name"":""Weight"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_WEIGHT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26363""},{""Name"":""Unit Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_UNIT_COST"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26364""},{""Name"":""Price per unit"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_PRICE_PER_UNIT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26365""},{""Name"":""Barcode Number"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_BARCODE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26366""},{""Name"":""Tax Cost Inclusive"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""ITEMS_TAX_COST_INCLUSIVE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:26367""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26230""},{""Name"":""Hot buttons"",""Visible"":true,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTONS"",""SubFields"":[{""Name"":""Pick List (Shift + K)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-hand-o-up"",""HotButtonKey"":""TemplateDefined,Pick List"",""$$hashKey"":""object:26385""},{""Name"":""Shipping Labels (Shift + S)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-ticket"",""HotButtonKey"":""TemplateDefined,Shipping Labels"",""$$hashKey"":""object:26386""},{""Name"":""Print Invoices (Shift + I)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-file-text-o"",""HotButtonKey"":""TemplateDefined,Invoice Template"",""$$hashKey"":""object:26387""},{""Name"":""Process Orders (Shift + P)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-gavel"",""HotButtonKey"":""ProcessOrders"",""$$hashKey"":""object:26388""},{""Name"":""Shipping Label - Template"",""Code"":""HOT_BUTTON"",""HotButtonKey"":""PrintSpecificInvoice_52"",""Visible"":true,""$$hashKey"":""object:26389""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:26231""}],""Filters"":{""GENERAL_INFO"":[{""FieldCode"":""GENERAL_INFO_LABEL_PRINTED"",""Name"":""Label printed"",""FieldType"":""Boolean"",""Value"":""true""}],""SHIPPING_INFORMATION"":[],""CUSTOMER"":[],""TOTALS"":[],""FOLDER"":[],""ITEMS"":[]},""Sorting"":{""GENERAL_INFO"":[{""Name"":""Order Id"",""FieldCode"":""GENERAL_INFO_ORDER_ID"",""Direction"":0,""Order"":1}],""SHIPPING_INFORMATION"":[],""CUSTOMER"":[],""TOTALS"":[],""FOLDER"":[],""ITEMS"":[]},""ColumnsConfig"":[{""Code"":""GENERAL_INFO"",""Column"":""generalInfoColumn"",""Width"":""15%""},{""Code"":""SHIPPING_INFORMATION"",""Column"":""shippingInfoColumn"",""Width"":""15%""},{""Code"":""CUSTOMER"",""Column"":""customerInfoColumn"",""Width"":""15%""},{""Code"":""TOTALS"",""Column"":""totalsInfoColumn"",""Width"":""15%""},{""Code"":""FOLDER"",""Column"":""folderInfoColumn"",""Width"":""20%""},{""Code"":""ITEMS"",""Column"":""itemsInfoColumn"",""Width"":""20%""}]}"
                };

                RestRequest request = new RestRequest();
                request.Method = Method.Post;

                request.AddHeader("Authorization", token);
                request.AddHeader("Content-Type", "application/json");

                var filterJson = JsonConvert.SerializeObject(filter);
                request.AddParameter("application/json", filterJson, ParameterType.RequestBody);

                RestResponse response = client.Execute(request);
            }
            catch (Exception ex)
            {

            }
        }

        public void LabelErrorView(string token, string serverUrl = "https://eu-ext.linnworks.net")
        {
            try
            {
                var client = new RestClient(serverUrl + "/api/Orders/CreateOrderView");

                CreateOrderViewRequestDto filter = new CreateOrderViewRequestDto()
                {
                    viewName = "Label Error",
                    OrderViewDetailJSON = @"{""FieldsVisibility"":[{""Name"":""General"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""GENERAL_INFO"",""SubFields"":[{""Name"":""Order Id"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_ORDER_ID"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39236""},{""Name"":""Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39237""},{""Name"":""Channel Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_CHANNEL_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39238""},{""Name"":""External Reference Number"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""GENERAL_INFO_EXTERNAL_REFERENCE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39239""},{""Name"":""Date"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Date"",""Code"":""GENERAL_INFO_DATE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39240""},{""Name"":""Source"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_SOURCE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39241""},{""Name"":""Sub Source"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_SUBSOURCE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39242""},{""Name"":""Label printed"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_LABEL_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39243""},{""Name"":""Invoice printed"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_INVOICE_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39244""},{""Name"":""Pick list printed"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PICK_LIST_PRINTED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39245""},{""Name"":""Rules engine run"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_IS_RULE_RUN"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39246""},{""Name"":""Part shipped"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PART_SHIPPED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39247""},{""Name"":""Locked"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_LOCKED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39248""},{""Name"":""Parked"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_PARKED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39249""},{""Name"":""Number of notes"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""GENERAL_INFO_NOTE_COUNT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39250""},{""Name"":""Tag"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""HtmlList"",""Code"":""GENERAL_INFO_TAG"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39251""},{""Name"":""Identifiers"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""List"",""Code"":""GENERAL_INFO_IDENTIFIER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39252""},{""Name"":""Status"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""GENERAL_INFO_STATUS"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39253""},{""Name"":""Delivery Dates"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Date"",""Code"":""GENERAL_INFO_DESPATCHBYDATE"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39254""},{""Name"":""Number of Items"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""GENERAL_INFO_ITEMS_COUNT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39255""},{""Name"":""Shipping Label Error"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""Text"",""Code"":""GENERAL_INFO_SHIPPING_LABEL_ERROR"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":true,""$$hashKey"":""object:39256""},{""Name"":""Has Shipping Label Error"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""Boolean"",""Code"":""GENERAL_INFO_HAS_SHIPPING_LABEL_ERROR"",""SubFields"":[],""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":true,""$$hashKey"":""object:39257""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39214""},{""Name"":""Shipping"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""SHIPPING_INFORMATION"",""SubFields"":[{""Name"":""Service Id"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_SERVICE_ID"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39280""},{""Name"":""Vendor"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_VENDOR"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39281""},{""Name"":""Service"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_SERVICE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39282""},{""Name"":""Weight"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""SHIPPING_INFORMATION_WEIGHT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39283""},{""Name"":""Packaging Group"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_PACKAGING_GROUP"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39284""},{""Name"":""Packaging Type"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""SHIPPING_INFORMATION_PACKAGING_TYPE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39285""},{""Name"":""Shipping Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""SHIPPING_INFORMATION_COST"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39286""},{""Name"":""Tracking Number"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""SHIPPING_INFORMATION_TRACKING_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39287""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39215""},{""Name"":""Customer"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""CUSTOMER"",""SubFields"":[{""Name"":""Address 1"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS1"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39296""},{""Name"":""Address 2"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS2"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39297""},{""Name"":""Address 3"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_ADDRESS3"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39298""},{""Name"":""Company"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_COMPANY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39299""},{""Name"":""Customer Name"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_FULL_NAME"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39300""},{""Name"":""Post code"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_POSTCODE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39301""},{""Name"":""Town"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_TOWN"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39302""},{""Name"":""Billing Address"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""None"",""Code"":""CUSTOMER_BILLING_ADDRESS"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39303""},{""Name"":""Region"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_ADDRESS_COUNTY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39304""},{""Name"":""Country"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""CUSTOMER_ADDRESS_COUNTRY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39305""},{""Name"":""Country Zone"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""CUSTOMER_ADDRESS_COUNTRY_ZONE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39306""},{""Name"":""Email"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_EMAIL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39307""},{""Name"":""Channel buyer name"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_CHANNEL_BUYER_NAME"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39308""},{""Name"":""Phone"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""CUSTOMER_PHONE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39309""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39216""},{""Name"":""Totals"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""TOTALS"",""SubFields"":[{""Name"":""Subtotal"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_SUBTOTAL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39324""},{""Name"":""Shipping"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_SHIPPING"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39325""},{""Name"":""Tax"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_TAX"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39326""},{""Name"":""Total"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""TOTALS_TOTAL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39327""},{""Name"":""Currency"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_CURRENCY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39328""},{""Name"":""Payment method"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_PAYMENT_METHOD"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39329""},{""Name"":""Country tax rate"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""TOTALS_COUNTRY_TAX_RATE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39330""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39217""},{""Name"":""Folder"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""FOLDER"",""SubFields"":[{""Name"":""Folder"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""FOLDER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39338""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39218""},{""Name"":""Items"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS"",""SubFields"":[{""Name"":""Image"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""ITEMS_IMAGE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39340""},{""Name"":""SKU"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_SKU"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39341""},{""Name"":""Original SKU"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_ORIGINAL_SKU"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39342""},{""Name"":""Title"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_TITLE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39343""},{""Name"":""Original Title"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Text"",""Code"":""ITEMS_ORIGINAL_TITLE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39344""},{""Name"":""Quantity"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Integer"",""Code"":""ITEMS_QUANTITY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39345""},{""Name"":""Line Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Decimal"",""Code"":""ITEMS_LINE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39346""},{""Name"":""Currency"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_CURRENCY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39347""},{""Name"":""Product Category"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""List"",""Code"":""ITEMS_CATEGORY"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39348""},{""Name"":""Stock Level"",""Visible"":true,""CanFilter"":true,""CanSort"":false,""FieldType"":""List"",""Code"":""STOCK_LEVEL"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39349""},{""Name"":""Bin Rack"",""Visible"":true,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_BINRACK"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39350""},{""Name"":""Batched"",""Visible"":false,""CanFilter"":true,""CanSort"":false,""FieldType"":""Boolean"",""Code"":""ITEMS_BATCHED"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39351""},{""Name"":""Weight"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_WEIGHT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39352""},{""Name"":""Unit Cost"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_UNIT_COST"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39353""},{""Name"":""Price per unit"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""None"",""Code"":""ITEMS_PRICE_PER_UNIT"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39354""},{""Name"":""Barcode Number"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Text"",""Code"":""ITEMS_BARCODE_NUMBER"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39355""},{""Name"":""Tax Cost Inclusive"",""Visible"":false,""CanFilter"":true,""CanSort"":true,""FieldType"":""Boolean"",""Code"":""ITEMS_TAX_COST_INCLUSIVE"",""SubFields"":null,""HotButtonIcon"":null,""HotButtonKey"":null,""IsFilterOnly"":false,""$$hashKey"":""object:39356""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39219""},{""Name"":""Hot buttons"",""Visible"":true,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTONS"",""SubFields"":[{""Name"":""Pick List (Shift + K)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-hand-o-up"",""HotButtonKey"":""TemplateDefined,Pick List"",""$$hashKey"":""object:39374""},{""Name"":""Shipping Labels (Shift + S)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-ticket"",""HotButtonKey"":""TemplateDefined,Shipping Labels"",""$$hashKey"":""object:39375""},{""Name"":""Print Invoices (Shift + I)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-file-text-o"",""HotButtonKey"":""TemplateDefined,Invoice Template"",""$$hashKey"":""object:39376""},{""Name"":""Process Orders (Shift + P)"",""Visible"":false,""CanFilter"":false,""CanSort"":false,""FieldType"":""Button"",""Code"":""HOT_BUTTON"",""SubFields"":null,""HotButtonIcon"":""fa fa-gavel"",""HotButtonKey"":""ProcessOrders"",""$$hashKey"":""object:39377""},{""Name"":""Shipping Label - Template"",""Code"":""HOT_BUTTON"",""HotButtonKey"":""PrintSpecificInvoice_52"",""Visible"":true,""$$hashKey"":""object:39378""}],""HotButtonIcon"":null,""HotButtonKey"":null,""$$hashKey"":""object:39220""}],""Filters"":{""GENERAL_INFO"":[{""FieldCode"":""GENERAL_INFO_HAS_SHIPPING_LABEL_ERROR"",""Name"":""Has Shipping Label Error"",""FieldType"":""Boolean"",""Value"":""true""}],""SHIPPING_INFORMATION"":[],""CUSTOMER"":[],""TOTALS"":[],""FOLDER"":[],""ITEMS"":[]},""Sorting"":{""GENERAL_INFO"":[{""Name"":""Order Id"",""FieldCode"":""GENERAL_INFO_ORDER_ID"",""Direction"":0,""Order"":1}],""SHIPPING_INFORMATION"":[],""CUSTOMER"":[],""TOTALS"":[],""FOLDER"":[],""ITEMS"":[]},""ColumnsConfig"":[{""Code"":""GENERAL_INFO"",""Column"":""generalInfoColumn"",""Width"":""15%""},{""Code"":""SHIPPING_INFORMATION"",""Column"":""shippingInfoColumn"",""Width"":""15%""},{""Code"":""CUSTOMER"",""Column"":""customerInfoColumn"",""Width"":""15%""},{""Code"":""TOTALS"",""Column"":""totalsInfoColumn"",""Width"":""15%""},{""Code"":""FOLDER"",""Column"":""folderInfoColumn"",""Width"":""20%""},{""Code"":""ITEMS"",""Column"":""itemsInfoColumn"",""Width"":""20%""}]}"
                };

                RestRequest request = new RestRequest();
                request.Method = Method.Post;

                request.AddHeader("Authorization", token);
                request.AddHeader("Content-Type", "application/json");

                var filterJson = JsonConvert.SerializeObject(filter);
                request.AddParameter("application/json", filterJson, ParameterType.RequestBody);

                RestResponse response = client.Execute(request);
            }
            catch (Exception ex)
            {

            }

        }
    }

    public class InstallResponse
    {
        public bool success { get; set; }
    }
    public class UninstallResponse
    {
        public bool success { get; set; }
    }

}
